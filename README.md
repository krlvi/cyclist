# Cyclist

This projects helps with finding cycles between Java packages within a given `.jar` file. This knowledge can be used in modularizing a Java code-base.
Because the Java language permits cyclical dependencies between packages, it is frequent for projects to develop [strongly connected components](https://en.wikipedia.org/wiki/Strongly_connected_component) in the context of deployable targets (typically a `.jar` file).
Extracting modules out of a highly coupled jar is impossible so long as a circular dependency exists.

`Cyclist` first decompiles the target `.jar` with the wonderful [CFR](https://www.benf.org/other/cfr/). Each java package is treated as a node. The union of dependencies defined by all classes within the package are considered the dependencies of the package. Those dependencies are represented as edges, forming a [Directed Graph](https://en.wikipedia.org/wiki/Directed_graph) of packages inter-depending on each other. The application analizes the resulting graph and outputs the groups of disconnected components. This implementation uses the [Kosaraju's algorithm](https://en.wikipedia.org/wiki/Kosaraju%27s_algorithm) computing the strongly connected components in linear time.

## Usage
Have [Bazel](https://bazel.build/) installed.

```
bazel run :cyclist <absolute path to a .jar> 
```

## Example
In the output below it can be seen which java packages within the `idea.jar` are tightly coupled and should be treated as a single module when modularizing the code-base.

```
oss/cyclist - [masterâ—] $ bazel run :cyclist /home/kiril/opt/idea/current/lib/idea.jar > test.txt
INFO: Analyzed target //:cyclist (0 packages loaded, 0 targets configured).
INFO: Found 1 target...
Target //java/com/videlov/cyclist:cyclist up-to-date:
  bazel-bin/java/com/videlov/cyclist/cyclist.jar
  bazel-bin/java/com/videlov/cyclist/cyclist
INFO: Elapsed time: 0.063s, Critical Path: 0.00s
INFO: 0 processes.
INFO: Build completed successfully, 1 total action
INFO: Build completed successfully, 1 total action

============================================
com.intellij.testFramework.exceptionCases
============================================
com.intellij.designer.utils
============================================
org.jetbrains.idea.maven.utils.library.propertiesEditor
============================================
com.intellij.openapi.compiler.ex
============================================
com.intellij.dupLocator.treeView
============================================
com.intellij.formatting
============================================
com.intellij.execution.jvm
============================================
com.intellij.facet.ui.libraries
============================================
com.intellij.facet
============================================
com.intellij.ide.util.projectWizard.importSources.util
============================================
com.intellij.debugger.ui.impl.tree
============================================
com.intellij.testFramework.codeInsight.hierarchy
============================================
com.intellij.conversion
============================================
com.intellij.testFramework.utils.parameterInfo
============================================
com.intellij.compiler.impl.rmiCompiler
============================================
com.intellij.testFramework.utils
============================================
icons
============================================
com.intellij.ide.highlighter
============================================
com.intellij.dupLocator.equivalence
============================================
com.intellij.openapi.options
============================================
com.intellij.remoteServer.impl.util
============================================
com.intellij.designer.clipboard
============================================
org.jetbrains.builtInWebServer
============================================
com.intellij.openapi.editor.colors
============================================
com.intellij.build.output
============================================
com.intellij.openapi.util.io
============================================
com.intellij.openapi.deployment
============================================
com.intellij.debugger.memory.agent.extractor
============================================
com.intellij.openapi.vfs.impl
============================================
com.intellij.tests
============================================
com.intellij.designer.designSurface.feedbacks
============================================
com.intellij.openapi
============================================
com.intellij.module
============================================
com.intellij.codeInsight.navigation
com.intellij.testFramework
com.intellij.openapi.roots.ui
com.intellij.ide.structureView.impl.java
com.intellij.refactoring
com.intellij.openapi.externalSystem.service.project
com.intellij.openapi.roots.ui.configuration.artifacts.sourceItems
com.intellij.testFramework.builders
com.intellij.util.io.impl
com.intellij.debugger.memory.ui
com.intellij.openapi.roots.ui.configuration.projectRoot.daemon
com.intellij.testFramework.fixtures.impl
com.intellij.openapi.roots.ui.configuration.projectRoot
com.intellij.openapi.wm.impl.welcomeScreen
com.intellij.openapi.externalSystem.service.settings
org.jetbrains.idea.maven.utils.library
com.intellij.debugger.jdi
com.intellij.openapi.externalSystem.importing
com.intellij.debugger.ui.impl
com.intellij.util.xml.impl
com.intellij.debugger.engine.evaluation
com.intellij.compiler.actions
com.intellij.execution.testDiscovery.actions
com.intellij.openapi.externalSystem.statistics
com.intellij.ide.util.frameworkSupport
com.intellij.idea
com.intellij.debugger.impl
com.intellij.compiler.progress
com.intellij.debugger.ui.breakpoints
com.intellij.openapi.roots.ui.configuration.artifacts
com.intellij.openapi.externalSystem.service.internal
com.intellij.lang.java
com.intellij.compiler.impl.javaCompiler
com.intellij.util.xml.highlighting
org.jetbrains.java.debugger.breakpoints.properties
com.intellij.util.ui.classpath
com.intellij.openapi.projectRoots.impl
com.intellij.execution.testDiscovery
com.intellij.debugger.memory.utils
com.intellij.debugger.ui.impl.watch
com.intellij.debugger.ui
com.intellij.openapi.roots.ui.configuration.classpath
com.intellij.ide.util.newProjectWizard
com.intellij.util.xml.structure
com.intellij.execution.impl
com.intellij.openapi.application.ex
com.intellij.openapi.roots.ui.configuration.libraries
org.jetbrains.java.debugger
com.intellij.util.xml.stubs.index
com.intellij.testFramework.utils.inlays
com.intellij.facet.impl.ui.libraries
com.intellij.packaging.impl.ui.properties
com.intellij.debugger.codeinsight
com.intellij.openapi.externalSystem.view
com.intellij.compiler.ant
com.intellij.openapi.externalSystem.service.project.wizard
com.intellij.framework
com.intellij.openapi.externalSystem.service.remote.wrapper
com.intellij.debugger.memory.component
com.intellij.ide.util.projectWizard.importSources.impl
com.intellij.debugger.impl.descriptors.data
com.intellij.execution.junit2.info
com.intellij.openapi.roots.ui.configuration.libraryEditor
com.intellij.openapi.externalSystem.service.remote
com.intellij.execution.testframework
com.intellij.openapi.projectRoots.ui
com.intellij.debugger.engine
com.intellij.execution.util
com.intellij.debugger.ui.tree.actions
com.intellij.debugger.memory.agent
com.intellij.openapi.externalSystem.task
com.intellij.debugger.impl.attach
com.intellij.openapi.externalSystem.service.project.autoimport
com.intellij.testFramework.fixtures
org.jetbrains.java.debugger.breakpoints
com.intellij.packaging.impl.elements
com.intellij.testIntegration
com.intellij.facet.impl.ui.actions
com.intellij.task.impl
com.intellij.execution.runners
com.intellij.execution.testDiscovery.indices
com.intellij.util.io
com.intellij.openapi.roots.ui.configuration.artifacts.nodes
com.intellij.codeInsight.unwrap
com.intellij.jarRepository.settings
com.intellij.debugger.ui.tree.render
com.intellij.openapi.roots.ui.configuration.actions
com.intellij.execution.filters
com.intellij.util.xml
com.intellij.openapi.externalSystem.service.project.settings
com.intellij.compiler.impl.javaCompiler.javac
com.intellij.debugger.ui.tree
com.intellij.execution.ui
com.intellij.framework.addSupport
com.intellij.platform.templates
com.intellij.debugger.ui.impl.nodes
com.intellij.debugger.ui.overhead
com.intellij.debugger.memory.agent.parsers
com.intellij.openapi.externalSystem.service.project.manage
com.intellij.project
com.intellij.packaging.impl.compiler
com.intellij.facet.impl
com.intellij.openapi.externalSystem.service.ui
com.intellij.codeInsight.daemon.impl
com.intellij.ide
com.intellij.framework.addSupport.impl
com.intellij.execution.stacktrace
com.intellij.packaging.impl.ui
com.intellij.openapi.compiler.util
com.intellij.compiler.impl
com.intellij.facet.impl.ui.facetType
com.intellij.framework.library
com.intellij.openapi.externalSystem.service.execution
com.intellij
com.intellij.ide.util.projectWizard
com.intellij.debugger.engine.events
com.intellij.debugger
com.intellij.openapi.externalSystem.action
com.intellij.mock
com.intellij.compiler.options
com.intellij.debugger.memory.tracking
com.intellij.ide.impl
com.intellij.util.xml.ui
com.intellij.ide.actions
com.intellij.execution.remote
com.intellij.openapi.externalSystem.model.settings
com.intellij.openapi.externalSystem.service.execution.cmd
com.intellij.execution.junit2
com.intellij.xml.impl.dom
com.intellij.debugger.settings
com.intellij.ide.util.importProject
com.intellij.packaging.impl.artifacts
com.intellij.util.xml.reflect
com.intellij.compiler
com.intellij.openapi.roots.ui.configuration.artifacts.actions
com.intellij.openapi.roots
com.intellij.openapi.roots.ui.configuration
com.intellij.openapi.roots.ui.configuration.artifacts.sourceItems.actions
com.intellij.debugger.engine.requests
com.intellij.util.xml.stubs
com.intellij.ide.projectWizard
com.intellij.openapi.compiler.generic
com.intellij.ide.util.projectWizard.importSources
com.intellij.framework.library.impl
com.intellij.facet.impl.ui
com.intellij.compiler.server
com.intellij.openapi.externalSystem.util
com.intellij.openapi.externalSystem.model
com.intellij.debugger.engine.evaluation.expression
com.intellij.compiler.impl.javaCompiler.eclipse
com.intellij.execution.actions
com.intellij.debugger.memory.filtering
com.intellij.projectImport
com.intellij.execution.junit
com.intellij.compiler.server.impl
com.intellij.openapi.externalSystem.service.notification.callback
com.intellij.compiler.ant.artifacts
com.intellij.execution
com.intellij.debugger.actions
com.intellij.openapi.externalSystem.service.task.ui
com.intellij.jarRepository
com.intellij.ide.util.newProjectWizard.modes
com.intellij.openapi.roots.impl
com.intellij.openapi.externalSystem.service.notification
com.intellij.codeInsight
com.intellij.ide.util.newProjectWizard.impl
com.intellij.openapi.externalSystem.model.internal
com.intellij.openapi.externalSystem.service
============================================
com.intellij.psi.formatter
============================================
com.intellij.testFramework.rules
============================================
com.intellij.dupLocator.treeHash
com.intellij.dupLocator.util
com.intellij.dupLocator
com.intellij.dupLocator.iterators
============================================
org.jetbrains.lang.manifest
============================================
org.jetbrains.lang.manifest.psi
org.jetbrains.lang.manifest.header
org.jetbrains.lang.manifest.psi.impl
============================================
org.jetbrains.lang.manifest.completion
============================================
org.jetbrains.lang.manifest.header.impl
org.jetbrains.lang.manifest.parser
============================================
org.jetbrains.lang.manifest.highlighting
============================================
com.intellij.codeInsight.problems
============================================
com.intellij.jarFinder
============================================
com.intellij.dupLocator.index
============================================
com.intellij.ide.macro
============================================
com.intellij.projectView
============================================
com.intellij.util.descriptors.impl
============================================
com.intellij.structuralsearch.impl.matcher.strategies
============================================
com.intellij.ide.java
============================================
com.intellij.util.xml.model.gotosymbol
============================================
com.intellij.util.xml.tree.actions
============================================
com.intellij.util.xml.stubs.builder
============================================
com.intellij.ide.projectView.actions
============================================
com.intellij.structuralsearch.impl.matcher
com.intellij.structuralsearch.plugin.util
com.intellij.structuralsearch.plugin.replace.impl
com.intellij.structuralsearch.impl.matcher.iterators
com.intellij.structuralsearch.plugin.replace
com.intellij.structuralsearch.plugin.replace.ui
com.intellij.structuralsearch.impl.matcher.handlers
com.intellij.structuralsearch.plugin
com.intellij.structuralsearch.impl.matcher.filters
com.intellij.structuralsearch.impl.matcher.predicates
com.intellij.structuralsearch.plugin.ui.filters
com.intellij.structuralsearch.plugin.ui
com.intellij.structuralsearch.impl.matcher.compiler
com.intellij.structuralsearch
============================================
com.intellij.structuralsearch.inspection.highlightTemplate
============================================
com.intellij.refactoring.typeMigration
============================================
com.intellij.refactoring.typeMigration.rules
============================================
com.intellij.refactoring.typeMigration.intentions
============================================
com.intellij.refactoring.typeMigration.rules.guava
com.intellij.refactoring.typeMigration.inspections
============================================
com.intellij.openapi.vcs.checkout
============================================
com.intellij.framework.impl
============================================
com.intellij.openapi.roots.ui.configuration.libraries.impl
============================================
com.intellij.openapi.externalSystem.configurationStore
============================================
com.intellij.compiler.impl.vcs
============================================
com.intellij.editor
============================================
com.intellij.testFramework.propertyBased
============================================
com.intellij.psi.codeStyle.arrangement
============================================
com.intellij.codeInsight.folding.impl
============================================
com.intellij.packaging.impl.ui.actions
============================================
com.intellij.compiler.backwardRefs
com.intellij.compiler.chainsSearch
com.intellij.compiler.chainsSearch.context
com.intellij.compiler.backwardRefs.view
com.intellij.compiler.chainsSearch.completion.lookup
============================================
com.intellij.compiler.inspection
============================================
com.intellij.packaging.impl.run
============================================
com.intellij.remoteServer.impl.configuration.deployment
============================================
com.intellij.debugger.memory.action
============================================
com.intellij.debugger.memory.action.tracking
============================================
com.intellij.execution.configurations.coverage
com.intellij.coverage.actions
com.intellij.coverage.view
com.intellij.coverage
============================================
com.intellij.execution.applet
============================================
com.intellij.execution.application
============================================
com.intellij.execution.jar
============================================
com.intellij.execution.jshell
============================================
com.intellij.remoteServer.impl.runtime.deployment.debug
============================================
com.intellij.compiler.chainsSearch.completion
============================================
com.intellij.execution.scratch
============================================
com.intellij.openapi.externalSystem.action.task
============================================
com.intellij.remoteServer.impl.module
============================================
com.intellij.designer.inspection
com.intellij.designer.componentTree
com.intellij.designer.model
com.intellij.designer.palette
com.intellij.designer
com.intellij.designer.propertyTable
com.intellij.designer.propertyTable.actions
com.intellij.designer.actions
com.intellij.designer.designSurface
com.intellij.designer.designSurface.tools
============================================
com.intellij.designer.propertyTable.editors
============================================
com.intellij.designer.propertyTable.renderers
============================================
com.intellij.designer.designSurface.selection
============================================
```
